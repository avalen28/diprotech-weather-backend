<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>JSDoc: Source: utils/location.js</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link
      type="text/css"
      rel="stylesheet"
      href="styles/prettify-tomorrow.css"
    />
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css" />
  </head>

  <body>
    <div id="main">
      <h1 class="page-title">Source: utils/location.js</h1>

      <section>
        <article>
          <pre
            class="prettyprint source linenums"
          ><code>const locationsData = require("../data/locations_ES.json");
const turf = require("@turf/turf");

/**
 * Service for handling location-based operations.
 */

class LocationService {
  /**
   * Constructs a LocationService instance.
   * @param {number} long - The longitude of the location.
   * @param {number} lat - The latitude of the location.
   * @property {Array&lt;number>} coordinates - The [longitude, latitude] pair for the location.
   */
  constructor(long, lat) {
    this.long = long;
    this.lat = lat;
    this.coordinates = [this.long, this.lat];
  }

  /**
   * Checks if the provided coordinates are valid.
   * @returns {boolean} True if the coordinates are valid, otherwise false.
   */
  areValidCoordinates = () =>
    this.isValidLongitude(this.long) &amp;&amp; this.isValidLatitude(this.lat);

  /**
   * Checks if the latitude is valid.
   * @returns {boolean} True if the latitude is valid, otherwise false.
   */
  isValidLatitude = () => !isNaN(this.lat) &amp;&amp; this.lat >= -90 &amp;&amp; this.lat &lt;= 90;

  /**
   * Checks if the longitude is valid.
   * @returns {boolean} True if the longitude is valid, otherwise false.
   */
  isValidLongitude = () =>
    !isNaN(this.long) &amp;&amp; this.long >= -180 &amp;&amp; this.long &lt;= 180;

  /**
   * Finds nearby locations based on the given coordinates.
   * @param {number} amount - The number of nearby locations to return.
   * @returns {Array} An array of nearby locations.
   */
  findNearbyLocations = (amount) => {
    return locationsData
      .sort(
        (a, b) =>
          this.calculateDistanceBetweenTwoCities(
            this.coordinates,
            a.location.coordinates
          ) -
          this.calculateDistanceBetweenTwoCities(
            this.coordinates,
            b.location.coordinates
          )
      )
      .slice(0, amount);
  };

  /**
   * Calculates the distance between two cities in kilometers.
   * @param {Array&lt;number>} firstCityCoor - The coordinates of the first city.
   * @param {Array&lt;number>} secondCityCoor - The coordinates of the second city.
   * @returns {number} The distance between the two cities in kilometers.
   */
  calculateDistanceBetweenTwoCities(firstCityCoor, secondCityCoor) {
    const from = turf.point(firstCityCoor);
    const to = turf.point(secondCityCoor);
    const options = { units: "kilometers" };
    return turf.distance(from, to, options);
  }
  /**
   * Constructs a URL for fetching weather data for a given city.
   * @param {Object} currentCity - The city object.
   * @param {Array&lt;number>} currentCity.location.coordinates - The coordinates of the city.
   * @returns {string} The URL to fetch weather data.
   */
  getUrl(currentCity) {
    const [long, lat] = currentCity.location.coordinates;
    return `https://api.openweathermap.org/data/2.5/forecast/daily?lat=${lat}&amp;lon=${long}&amp;cnt=10&amp;appid=${process.env.OPENWEATHER_API_KEY}`;
  }
}

module.exports = { LocationService };
</code></pre>
        </article>
      </section>
    </div>

    <nav>
      <h2><a href="index.html">Home</a></h2>
      <h3>Classes</h3>
      <ul>
        <li><a href="LocationService.html">LocationService</a></li>
      </ul>
      <h3>Global</h3>
      <ul>
        <li><a href="global.html#get/weather-data">get/weather-data</a></li>
        <li><a href="global.html#storeData">storeData</a></li>
      </ul>
    </nav>

    <br class="clear" />

    <footer>
      Documentation generated by
      <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Thu Aug 08
      2024 10:25:20 GMT+0200 (Central European Summer Time)
    </footer>

    <script>
      prettyPrint();
    </script>
    <script src="scripts/linenumber.js"></script>
  </body>
</html>
